!function(){"use strict";angular.module("tb-free-draw",[]).directive("tbFreeDraw",["$timeout",function(e){return{restrict:"A",scope:{drawTo:"="},link:function(t,n){function o(){function n(e){var t=e.changedTouches[0],n=a.getBoundingClientRect();e.preventDefault(),u.lineTo(t.clientX-n.left,t.clientY-n.top),u.stroke()}function o(e){a.removeEventListener("touchmove",n,!1),c(a.toDataURL("image/png"))}function i(e){var t=e.changedTouches[0];u.moveTo(t.pageX,t.pageY),u.beginPath(),a.addEventListener("touchmove",n,!1),a.addEventListener("touchend",o,!1),a.addEventListener("touchleave",o,!1)}function c(e){t.$apply(function(){t.drawTo=e})}function r(){var t=a.getBoundingClientRect(),n=a.getContext("2d");n.clearRect(0,0,t.width,t.height),e(function(){c(a.toDataURL("image/png"))},0)}var u=a.getContext("2d");t.$on("tb.freedraw.clear",r),a.addEventListener("touchstart",i,!1)}var a=n[0];"CANVAS"===a.nodeName&&o()}}}])}();