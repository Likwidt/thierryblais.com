!function(){"use strict";function e(){function e(e){var t=10>e?["00",e].join(""):100>e?["0",e].join(""):e;return t}function t(e){var t=10>e?["0",e].join(""):e;return t}function i(e,i){var n=Math.floor(e/60),o=t("up"!=i?Math.floor(e%60):Math.ceil(e%60));return[n,":",o].join("")}function n(){var e,t=document.createElement("fakeelement"),i=["OTransform","MozTransform","WebkitTransform"];for(e in i)if("undefined"!=typeof t.style[i[e]])return i[e];return"transform"}function o(){var e,t=document.createElement("fakeelement"),i={transition:"transitionend",OTransition:"oTransitionEnd",MozTransition:"transitionend",WebkitTransition:"webkitTransitionEnd"};for(e in i)if(void 0!==t.style[e])return i[e]}var s=this;s.pad3=e,s.pad2=t,s.parseTime=i,s.whichTransitionEvent=o,s.browserTransform=n}function t(){return{restrict:"E",replace:!0,scope:{data:"=",slides:"=",src:"=",videoEnd:"&"},controller:"TbVideoPlayerCtrl",templateUrl:"js/directives/templates/videoPlayer.html",link:function(e,t,i){function n(){"function"==typeof e.videoEnd&&e.video.addEventListener("ended",e.videoEnd,!1)}function o(){for(var t=e.slides.length-1;t--;){if(!e.slides[t].hasOwnProperty("timeIndex"))return e.STATES.hasSlides=!1,console.error('Object used in "slides" attribute is missing property: "timeIndex"'),!1;if(!e.slides[t].hasOwnProperty("slideUrl"))return e.STATES.hasSlides=!1,console.error('Object used in "slides" attribute is missing property: "slideUrl"'),!1}return!0}e.master=t[0],e.video=e.master.querySelector("video"),e.STATES={},e.STATES.hasControls="undefined"!=typeof i.controls,e.STATES.hasSlides="undefined"!=typeof e.slides&&!!e.slides.length&&o(),e.video.addEventListener("canplay",n,!1)}}}angular.module("tb-video-player",["tb-video-player.templates"]).controller("TbVideoPlayerCtrl",[e]).directive("tbVideoPlayer",[t]).filter("trustUrl",["$sce",function(e){return function(t){return e.trustAsResourceUrl(t)}}])}(),function(){"use strict";function e(){return{restrict:"E",replace:!0,require:"^tbVideoPlayer",templateUrl:"js/directives/templates/videoSlides.html",link:function(e,t,i,n){function o(){v={videoDimensions:{bounds:m.video.getBoundingClientRect()},slideDimensions:{bounds:m.slideContainer.getBoundingClientRect(),offsetLeft:m.slideContainer.offsetLeft,offsetTop:m.slideContainer.offsetTop},fullSizeSlide:null,scale:null,pictureChanged:!1,needsResize:!1}}function s(e){v.needsResize=!0,S||o(),a(e)}function r(){S?(null===v.fullSizeSlide&&(v.fullSizeSlide=m.slideContainer.getBoundingClientRect()),m.slideClone.style.top=v.fullSizeSlide.top-m.master.offsetTop+"px",m.slideClone.style.left=v.fullSizeSlide.left-m.master.offsetLeft+"px",m.slideClone.style.width=v.fullSizeSlide.width+"px",m.slideClone.style.height=v.fullSizeSlide.height+"px",m.slideClone.classList.add("visible")):v.needsResize===!0&&o()}function d(){var e=v.videoDimensions.bounds.width/v.slideDimensions.bounds.width,t=v.videoDimensions.bounds.height/v.slideDimensions.bounds.height;return Math.min(e,t)}function l(e){null===v.scale&&(v.scale=d());var t=-1*(v.slideDimensions.offsetLeft-(v.videoDimensions.bounds.width-v.slideDimensions.bounds.width*v.scale)/2)+"px",i=-1*v.slideDimensions.offsetTop+"px";e.preventDefault(),m.slideContainer.style[p]="translate("+t+", "+i+") scale("+v.scale+")",S=!0}function a(e){e.preventDefault(),m.slideContainer.style[p]=null,m.slideClone.classList.remove("visible"),S=!1}function u(){function t(){e.STATES.currentSlideImgSrc=i,v.pictureChanged=!0}var i,n=Math.ceil(m.video.currentTime),s=T-1;for(v.pictureChanged===!0&&S===!1&&o();s--;)if(n>=e.slides[s].timeIndex&&n<e.slides[s+1].timeIndex)return i=e.slides[s].slideUrl,void(e.STATES.currentSlideImgSrc!==i&&e.$apply(t))}function c(){o(),m.slideImage=m.slideContainer.querySelector("img"),m.slideClone=m.master.querySelector(".video-slide-clone"),m.video.addEventListener("timeupdate",u,!1),m.slideContainer.addEventListener("mousedown",l,!1),m.slideContainer.addEventListener("touchstart",l,!1),m.slideClone.addEventListener("mousedown",a,!1),m.slideClone.addEventListener("touchstart",a,!1),m.slideContainer.addEventListener(f,r,!1),window.addEventListener("resize",s,!1)}var v,m={},f=n.whichTransitionEvent(),p=n.browserTransform(),S=!1,T=e.slides.length;m.slideContainer=t[0],m.master=e.master,m.video=e.video,m.video.addEventListener("canplay",c,!1)}}}angular.module("tb-video-player").directive("tbVideoSlide",[e])}(),function(){"use strict";function e(){return{restrict:"E",replace:!0,require:"^tbVideoPlayer",templateUrl:"js/directives/templates/videoControls.html",link:function(e,t,i,n){function o(t){S=T.video.duration,f=T.slider.getBoundingClientRect(),e.STATES.isPlaying=!T.video.paused,p=T.node.offsetWidth,s()}function s(){var e=T.video.currentTime,t=S-e;r(e,t)}function r(t,i){var o=t*f.width/S-p/2;T.node.style.left=[o,"px"].join(""),e.$apply(function(){e.STATES.timeIn=n.parseTime(t,"up"),e.STATES.timeLeft=n.parseTime(i,"down")})}function d(e){e.preventDefault(),f=T.slider.getBoundingClientRect(),T.video.removeEventListener("timeupdate",s),"touchstart"===e.type&&(T.node.addEventListener("touchmove",a,!1),T.node.addEventListener("touchend",l,!1)),"mousedown"===e.type&&(document.addEventListener("mousemove",a,!1),document.addEventListener("mouseup",l,!1))}function l(e){e.stopPropagation(),e.preventDefault(),T.video.currentTime=m,T.video.addEventListener("timeupdate",s,!1),"touchend"===e.type&&(T.node.removeEventListener("touchmove",a),T.node.removeEventListener("touchend",l)),"mouseup"===e.type&&(document.removeEventListener("mousemove",a),document.removeEventListener("mouseup",l))}function a(e){var t,i="touchmove"===e.type?e.touches[0]:e,n=i.pageX-f.left;e.preventDefault(),m=0>=n?0:n>=f.width?S:S*n/f.width,t=S-m,r(m,t)}function u(e){var t=T.video.currentTime;e.preventDefault(),T.video.currentTime=t>=y.skipTime?t-y.skipTime:0}function c(e){e.preventDefault(),T.video.currentTime<S-y.skipTime?T.video.currentTime+=y.skipTime:(T.video.pause(),T.video.currentTime=S)}function v(t){t.preventDefault(),e.$apply(function(){T.video.paused?T.video.play():T.video.pause(),e.STATES.isPlaying=!T.video.paused})}var m,f,p,S,T={},y={};T.controls=t[0],T.video=e.video,T.forwardButton=T.controls.querySelector(".fw30"),T.backButton=T.controls.querySelector(".back30"),T.slider=T.controls.querySelector(".slider"),T.node=T.controls.querySelector(".node"),T.playPause=T.controls.querySelector(".playPause"),T.timeIn=T.controls.querySelector(".timeIn"),T.timeLeft=T.controls.querySelector(".timeLeft"),y.skipTime=30,T.video.addEventListener("canplay",o,!1),T.video.addEventListener("timeupdate",s,!1),T.forwardButton.addEventListener("mousedown",c,!1),T.backButton.addEventListener("mousedown",u,!1),T.playPause.addEventListener("mousedown",v,!1),T.node.addEventListener("mousedown",d,!1),T.forwardButton.addEventListener("touchstart",c,!1),T.backButton.addEventListener("touchstart",u,!1),T.playPause.addEventListener("touchstart",v,!1),T.node.addEventListener("touchstart",d,!1)}}}angular.module("tb-video-player").directive("tbVideoControls",[e])}(),function(e){try{e=angular.module("tb-video-player.templates")}catch(t){e=angular.module("tb-video-player.templates",[])}e.run(["$templateCache",function(e){e.put("js/directives/templates/videoControls.html",'<div class="video-controls"><div class="controls"><div class="tb-vid_btn back30"></div><div class="tb-vid_btn playPause" ng-class="{ \'play\': !!STATES.isPlaying, \'pause\': !STATES.isPlaying }"></div><div class="tb-vid_btn fw30"></div><div class="progressIndicator"><div class="timeIn">{{ STATES.timeIn }}</div><div class="slider"><div class="node"></div></div><div class="timeLeft">{{ STATES.timeLeft }}</div></div></div></div>')}])}(),function(e){try{e=angular.module("tb-video-player.templates")}catch(t){e=angular.module("tb-video-player.templates",[])}e.run(["$templateCache",function(e){e.put("js/directives/templates/videoPlayer.html",'<div class="tb-video_container" ng-cloak=""><tb-video-slide ng-if="STATES.hasSlides"></tb-video-slide><tb-video-controls ng-if="STATES.hasControls"></tb-video-controls><video autoplay=""><source ng-src="{{ src | trustUrl }}" type="video/mp4"></video><img class="video-slide-clone" ng-src="{{ STATES.currentSlideImgSrc }}" ng-if="STATES.hasSlides"></div>')}])}(),function(e){try{e=angular.module("tb-video-player.templates")}catch(t){e=angular.module("tb-video-player.templates",[])}e.run(["$templateCache",function(e){e.put("js/directives/templates/videoSlides.html",'<div class="video-slide-thumb tb-slide-position"><img ng-src="{{ STATES.currentSlideImgSrc }}"></div>')}])}();
//# sourceMappingURL=tbVideoPlayer.min.js.map
